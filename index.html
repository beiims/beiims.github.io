<!doctype html>
<html>
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
      <title>GitHub Markdown CSS demo</title>
      <link rel="stylesheet" href="github-markdown.css">
      <style>
        body {
          box-sizing: border-box;
          min-width: 200px;
          max-width: 980px;
          margin: 0 auto;
          padding: 45px;
        }
      </style>
    </head>
	  <body>

<h1 id="-beiims-world-">/beiims.world/</h1>
<ul>
<li>I am <strong>beiims</strong>, an independent game developer, programmer, and musician.</li>
<li>I work mostly with <em>lua</em> and <em>bash</em>.</li>
</ul>
<hr>
<h5 id="levelmain-lua">LevelMain.lua</h5>
<p>This is a very simple scaling level system written in lua for application in Roblox.</p>
<pre><code class="lang-lua"><span class="hljs-keyword">local</span> replicatedStorage = game:GetService(<span class="hljs-string">"ReplicatedStorage"</span>)
<span class="hljs-keyword">local</span> events = replicatedStorage:WaitForChild(<span class="hljs-string">"Events"</span>)
<span class="hljs-keyword">local</span> levelDataLoaded = events:WaitForChild(<span class="hljs-string">"LevelDataLoaded"</span>)
<span class="hljs-keyword">local</span> level = game:GetService(<span class="hljs-string">"DataStoreService"</span>):GetOrderedDataStore(<span class="hljs-string">"Levels"</span>)
<span class="hljs-keyword">local</span> xp = game:GetService(<span class="hljs-string">"DataStoreService"</span>):GetOrderedDataStore(<span class="hljs-string">"XP"</span>)
<span class="hljs-keyword">local</span> requiredxp = game:GetService(<span class="hljs-string">"DataStoreService"</span>):GetOrderedDataStore(<span class="hljs-string">"RequiredXP"</span>)


game.Players.PlayerAdded:Connect(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(player)</span></span>

  <span class="hljs-keyword">local</span> playerName = player.Name

  <span class="hljs-keyword">local</span> Levels = Instance.new(<span class="hljs-string">"Folder"</span>)
  Levels.Name = <span class="hljs-string">"Levels"</span>
  Levels.Parent = player

  <span class="hljs-keyword">local</span> numLevel = Instance.new(<span class="hljs-string">"IntValue"</span>)
  numLevel.Name = <span class="hljs-string">"NumLevel"</span>
  numLevel.Parent = Levels

  <span class="hljs-keyword">local</span> numXP = Instance.new(<span class="hljs-string">"IntValue"</span>)
  numXP.Name = <span class="hljs-string">"NumXP"</span>
  numXP.Parent = Levels

  <span class="hljs-keyword">local</span> reqXP = Instance.new(<span class="hljs-string">"IntValue"</span>)
  reqXP.Name = <span class="hljs-string">"ReqXP"</span>
  reqXP.Parent = Levels

  <span class="hljs-keyword">local</span> numLevelSavedData = <span class="hljs-keyword">nil</span>
  <span class="hljs-keyword">local</span> numXPSavedData = <span class="hljs-keyword">nil</span>
  <span class="hljs-keyword">local</span> reqXPSavedData = <span class="hljs-keyword">nil</span>

  <span class="hljs-built_in">pcall</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    numLevelSavedData = level:GetAsync(<span class="hljs-built_in">tostring</span>(player.UserId))
  <span class="hljs-keyword">end</span>)

  <span class="hljs-keyword">if</span>  numLevelSavedData ~= <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span>
    numLevel.Value = numLevelSavedData
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"NumLevel data for player "</span>..player.UserId..<span class="hljs-string">" loaded"</span>)
  <span class="hljs-keyword">else</span>
    <span class="hljs-comment">-- New player</span>
    numLevel.Value = <span class="hljs-number">1</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-built_in">pcall</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    numXPSavedData = xp:GetAsync(<span class="hljs-built_in">tostring</span>(player.UserId))
  <span class="hljs-keyword">end</span>)

  <span class="hljs-keyword">if</span>  numXPSavedData ~= <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span>
    numXP.Value = numXPSavedData
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"NumXP data for player "</span>..player.UserId..<span class="hljs-string">" loaded"</span>)
  <span class="hljs-keyword">else</span>
    <span class="hljs-comment">-- New player</span>
    numXP.Value = <span class="hljs-number">0</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-built_in">pcall</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    reqXPSavedData = requiredxp:GetAsync(<span class="hljs-built_in">tostring</span>(player.UserId))
  <span class="hljs-keyword">end</span>)

  <span class="hljs-keyword">if</span>  reqXPSavedData ~= <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span>
    reqXP.Value = reqXPSavedData
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ReqXP data for player "</span>..player.UserId..<span class="hljs-string">" loaded"</span>)
  <span class="hljs-keyword">else</span>
    <span class="hljs-comment">-- New player</span>
    reqXP.Value = <span class="hljs-number">300</span>
  <span class="hljs-keyword">end</span>

  numXP.Changed:Connect(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">if</span> player:FindFirstChild(<span class="hljs-string">"Levels"</span>):WaitForChild(<span class="hljs-string">"NumXP"</span>).Value &gt;= player:FindFirstChild(<span class="hljs-string">"Levels"</span>):WaitForChild(<span class="hljs-string">"ReqXP"</span>).Value <span class="hljs-keyword">then</span>
      numLevel.Value = numLevel.Value + <span class="hljs-number">1</span>
      <span class="hljs-built_in">print</span>(<span class="hljs-string">"Level up!"</span>)
      <span class="hljs-keyword">local</span> step1 = numLevel.Value + <span class="hljs-number">1</span>
      <span class="hljs-keyword">local</span> step2 = numLevel.Value * step1
      <span class="hljs-keyword">local</span> step3 = step2/<span class="hljs-number">2</span> * <span class="hljs-number">100</span>
      <span class="hljs-keyword">local</span> requiredCalc = step3
      reqXP.Value = requiredCalc
      <span class="hljs-built_in">print</span>(reqXP.Value - numXP.Value..<span class="hljs-string">" experience needed to reach Level "</span>.. numLevel.Value + <span class="hljs-number">1</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>)

  levelDataLoaded:Fire(player)
<span class="hljs-keyword">end</span>)

game.Players.PlayerRemoving:Connect(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(player)</span></span>
  <span class="hljs-keyword">local</span> levels = player:WaitForChild(<span class="hljs-string">"Levels"</span>)
  <span class="hljs-keyword">local</span> numLevel = levels:WaitForChild(<span class="hljs-string">"NumLevel"</span>)
  <span class="hljs-keyword">if</span> numLevel.Value == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">local</span> ID = player.UserId
    <span class="hljs-built_in">pcall</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    level:SetAsync(ID,numLevel.Value)
    <span class="hljs-keyword">end</span>)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>)


game.Players.PlayerRemoving:Connect(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(player)</span></span>
  <span class="hljs-keyword">local</span> levels = player:WaitForChild(<span class="hljs-string">"Levels"</span>)
  <span class="hljs-keyword">local</span> numXP = levels:WaitForChild(<span class="hljs-string">"NumXP"</span>)
  <span class="hljs-keyword">if</span> numXP.Value == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">local</span> ID = player.UserId
    <span class="hljs-built_in">pcall</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    xp:SetAsync(ID,numXP.Value)
    <span class="hljs-keyword">end</span>)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>)

game.Players.PlayerRemoving:Connect(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(player)</span></span>
  <span class="hljs-keyword">local</span> levels = player:WaitForChild(<span class="hljs-string">"Levels"</span>)
  <span class="hljs-keyword">local</span> reqXP = levels:WaitForChild(<span class="hljs-string">"ReqXP"</span>)
  <span class="hljs-keyword">if</span> reqXP.Value == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">local</span> ID = player.UserId
    <span class="hljs-built_in">pcall</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    requiredxp:SetAsync(ID,reqXP.Value)
    <span class="hljs-keyword">end</span>)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>)

<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> game:GetService(<span class="hljs-string">"RunService"</span>):IsStudio() <span class="hljs-keyword">then</span>
  wait(<span class="hljs-number">5</span>)
  game:BindToClose(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">for</span> i, player <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(game.Players:GetPlayers()) <span class="hljs-keyword">do</span>
      <span class="hljs-keyword">if</span> player <span class="hljs-keyword">then</span>
        player:kick(<span class="hljs-string">"This game is shutting down"</span>)
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>

    wait(<span class="hljs-number">5</span>)

  <span class="hljs-keyword">end</span>)
<span class="hljs-keyword">end</span>
</code></pre>
      
  </body>
</html>
